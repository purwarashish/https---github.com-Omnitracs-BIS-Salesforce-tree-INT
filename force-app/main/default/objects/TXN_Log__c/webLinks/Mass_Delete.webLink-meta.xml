<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Mass_Delete</fullName>
    <availability>online</availability>
    <description>Mass Delete</description>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Mass Delete</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/9.0/connection.js&quot;)} 

var records = {!GETRECORDIDS( $ObjectType.Case )};
/*var records = {!GETRECORDIDS( $ObjectType.Event )};
var taskRecords = {!GETRECORDIDS( $ObjectType.Task)};
records = records.concat(taskRecords);*/

if (records[0] == null) {
	alert(&quot;Please select at least one record.&quot;);
} else {
	if (confirm(&quot;Are you Sure want to delete all the selected records!&quot;) == true) {
        var errors = []; 
		var result = sforce.connection.deleteIds(records); 
		if (result &amp;&amp; result.length){
			var numFailed = 0; 
			var numSucceeded = 0; 
			for (var i = 0; i &lt; result.length; i++){
				var res = result[i]; 
				if (res &amp;&amp; res.success == &apos;true&apos;){ 
					numSucceeded++; 
				} else {
					var es = res.getArray(&quot;errors&quot;); 
					if(es.length &gt; 0) {
						errors.push(es[0].message); 
					} 
					numFailed++; 
				} 
			}
			if (numFailed &gt; 0){ 
				alert(&quot;Failed: &quot; + numFailed + &quot;\nSucceeded: &quot; + numSucceeded + &quot; \n Due to: &quot; + errors.join(&quot;\n&quot;)); 
			} else {
				alert(&quot;Number of records deleted: &quot; + numSucceeded);
			}
		}
		window.location.reload();
    } else {
        //alert(&quot;No Worries&quot;);
    } 
}</url>
</WebLink>
